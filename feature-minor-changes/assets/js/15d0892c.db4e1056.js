"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[806],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return p}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=a.createContext({}),s=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,d=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(n),p=o,f=u["".concat(d,".").concat(p)]||u[p]||c[p]||i;return n?a.createElement(f,r(r({ref:t},m),{},{components:n})):a.createElement(f,r({ref:t},m))}));function p(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var s=2;s<i;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3174:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return d},metadata:function(){return s},toc:function(){return m},default:function(){return u}});var a=n(7462),o=n(3366),i=(n(7294),n(3905)),r=["components"],l={sidebar_position:0},d="Config",s={unversionedId:"reference/data_monitoring/config",id:"reference/data_monitoring/config",isDocsHomePage:!1,title:"Config",description:"To run redata you would usually need to set up some variables in your dbtproject.yml config. Below example configuration followed with an explanation of it.",source:"@site/docs/reference/data_monitoring/config.md",sourceDirName:"reference/data_monitoring",slug:"/reference/data_monitoring/config",permalink:"/re-data/feature-minor-changes/docs/reference/data_monitoring/config",editUrl:"https://github.com/re-data/re-data/edit/master/docs/docs/reference/data_monitoring/config.md",version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0},sidebar:"tutorialSidebar",previous:{title:"Data Validation",permalink:"/re-data/feature-minor-changes/docs/reference/data_preparation/data_validation"},next:{title:"Metrics",permalink:"/re-data/feature-minor-changes/docs/reference/data_monitoring/metrics"}},m=[{value:"re_data:time_window_start, re_data:time_window_end",id:"re_datatime_window_start-re_datatime_window_end",children:[]},{value:"re_data:schemas",id:"re_dataschemas",children:[]},{value:"re_data:monitored",id:"re_datamonitored",children:[]},{value:"re_data:metrics_base",id:"re_datametrics_base",children:[]},{value:"re_data:alerting_z_score",id:"re_dataalerting_z_score",children:[]},{value:"re_data:anomaly_detection_look_back_days",id:"re_dataanomaly_detection_look_back_days",children:[]}],c={toc:m};function u(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"config"},"Config"),(0,i.kt)("p",null,"To run re_data you would usually need to set up some variables in your ",(0,i.kt)("inlineCode",{parentName:"p"},"dbt_project.yml")," config. Below example configuration followed with an explanation of it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml",metastring:"dbt_project.yml","dbt_project.yml":!0},"# to enable re_data models\nmodels:\n  re_data:\n    enabled: true\n\nvars:\n  # if not passed, last day stats will be computed\n  re_data:time_window_start: '{{ (run_started_at - modules.datetime.timedelta(1)).strftime(\"%Y-%m-%d 00:00:00\") }}'\n  re_data:time_window_end: '{{ run_started_at.strftime(\"%Y-%m-%d 00:00:00\") }}'\n\n  # *required if you want to configure re_data in code (not in DB)\n  re_data:monitored:\n\n    - schema: dq_raw\n      database: postgres\n      tables:\n        - name: sample_table\n          time_filter: creation_time\n\n          # (optional) specify columns for which re_data should run\n          columns:\n            - event_type\n            - value1\n            - value2\n          \n          metrics: # my additional metrics for table\n            table:\n              - my_custom_table_metric\n              - distinct_rows:\n                  key: value # table metrics can take in config unique to it.\n\n            column:\n              event_type:\n                - distinct_count\n                - match_regex:\n                    regex: ([A-Za-z0-9]+) # passing a key value pair of config to a column metric.\n\n        - name: sample_with_anomaly\n          time_filter: creation_time\n\n      # this would work for all tables in the list\n      actively_monitored: true\n\n  # (optional) if not passed, all metrics below except custom \n  # ones will be used\n  re_data:metrics_base:\n    table:\n      - row_count\n      - freshness\n      - buy_count # my own custom metric\n      \n    column:\n      numeric:\n        - min\n        - max\n        - avg\n        - stddev\n        - variance\n        - nulls_count\n        - diff # my own custom metric\n        \n      text:\n        - min_length\n        - max_length\n        - avg_length\n        - nulls_count\n        - missing_count\n\n  # (optional) global z_score threshold to use for alerting\n  # usually keeping default will be enough\n  re_data:alerting_z_score: 3\n\n  # (optional) tells how much hisory you want to consider when looking for anomalies\n  re_data:anomaly_detection_look_back_days: 30\n")),(0,i.kt)("h3",{id:"re_datatime_window_start-re_datatime_window_end"},"re_data:time_window_start, re_data:time_window_end"),(0,i.kt)("p",null,"re_data metrics are time-based. (re_data filters all your table data to a specific time window.)\nIn general, we advise setting up a time window this way that all new data is monitored.\nIt's also possible to compute metrics from overlapping data for example last 7 days."),(0,i.kt)("p",null,"By default, re_data computes daily stats from the last day (it actually uses exact configuration from example for that)"),(0,i.kt)("h3",{id:"re_dataschemas"},"re_data:schemas"),(0,i.kt)("p",null,"Schemas you would like to monitor, re_data will inspect all tables from those schemas, you can choose which tables to monitor and can setup details about that either in:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"your dbt project (",(0,i.kt)("inlineCode",{parentName:"li"},"re_data:monitored")," var)"),(0,i.kt)("li",{parentName:"ul"},"in your database")),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"By default ",(0,i.kt)("inlineCode",{parentName:"p"},"re_data")," queries the same DB as your dbt project (usually defined in ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.dbt/profiles.yml")," file). In BigQuery and Snowflake, schemas passed can also take the form of ",(0,i.kt)("inlineCode",{parentName:"p"},"db_name.schema_name")," which will cause ",(0,i.kt)("inlineCode",{parentName:"p"},"re_data")," to query ",(0,i.kt)("inlineCode",{parentName:"p"},"db_name")," specified to find tables to monitor."))),(0,i.kt)("h3",{id:"re_datamonitored"},"re_data:monitored"),(0,i.kt)("p",null,"One of the most important settings. You can define here:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"what tables you would like to monitor"),(0,i.kt)("li",{parentName:"ul"},"what columns you would like to use for time filtering in them"),(0,i.kt)("li",{parentName:"ul"},"what metrics to compute for those tables")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"re_data:monitored")," is expected to be a list with elements containing: ",(0,i.kt)("inlineCode",{parentName:"p"},"schema"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"database"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"tables")," keys.\n",(0,i.kt)("inlineCode",{parentName:"p"},"tables")," key is expected to be a list of tables to monitor."),(0,i.kt)("p",null,"(",(0,i.kt)("inlineCode",{parentName:"p"},"schema"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"database")," keys are optional here, if not passed re_data will use dbt project schema/database to infer those, you still need to pass: ",(0,i.kt)("inlineCode",{parentName:"p"},"re_data:schemas")," with all schemas to monitor)"),(0,i.kt)("p",null,"Each element of ",(0,i.kt)("inlineCode",{parentName:"p"},"tables")," has:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name")," which is the name of the table (dbt model, seed, source)  "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"time_filter")," column for time filter (",(0,i.kt)("inlineCode",{parentName:"li"},"null")," in case you would like to compute global metric)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"actively_monitored")," information if you with to monitor table"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"columns")," if you would like to run re_data only for subset of columns specify them here"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"metrics")," what additional metrics you would like to compute for tables. Check out the exact syntax in the config example.")),(0,i.kt)("p",null,"Notice, above table settings, except ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," can be also set for all\ntables at once (check ",(0,i.kt)("inlineCode",{parentName:"p"},"actively_monitored: true")," usage in the example)"),(0,i.kt)("h3",{id:"re_datametrics_base"},"re_data:metrics_base"),(0,i.kt)("p",null,"This is a set of metrics to compute for all monitored tables.\nSome metrics like ",(0,i.kt)("inlineCode",{parentName:"p"},"row_count")," are table level, others are specified\nper column type: so that expression will be run for all columns of this type."),(0,i.kt)("p",null,"Here you only add metrics if you want to compute them for all tables which are monitored. If you want to add metrics to be computed for a specific table (or tables) you can do it with ",(0,i.kt)("inlineCode",{parentName:"p"},"re_data:monitored")," var."),(0,i.kt)("h3",{id:"re_dataalerting_z_score"},"re_data:alerting_z_score"),(0,i.kt)("p",null,"The threshold for alerting, you can leave it as is or update depending on your experience.  (By default it's 3)"),(0,i.kt)("h3",{id:"re_dataanomaly_detection_look_back_days"},"re_data:anomaly_detection_look_back_days"),(0,i.kt)("p",null,"The period which ",(0,i.kt)("inlineCode",{parentName:"p"},"re_data")," considers when looking for anomalies. (By default it's 30 days)"))}u.isMDXComponent=!0}}]);